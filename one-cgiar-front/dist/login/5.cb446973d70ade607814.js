(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{kQgB:function(t,e,o){"use strict";o.r(e),o.d(e,"UsersModule",(function(){return x}));var r=o("ofXK"),a=o("tyNb"),i=o("1G5W"),n=o("+0xr"),c=o("Dh3D"),s=o("0IaG"),l=o("fXoL"),d=o("/9La"),b=o("JIr8"),u=o("z6cu"),m=o("AytR"),h=o("tk/3");let f=(()=>{class t{constructor(t){this.http=t}getAll(){return this.http.get(m.a.API_URL+"/users").pipe(Object(b.a)(this.handlerError))}getById(t){return this.http.get(`${m.a.API_URL}/users/${t}`).pipe(Object(b.a)(this.handlerError))}new(t){return this.http.post(m.a.API_URL+"/users",t).pipe(Object(b.a)(this.handlerError))}update(t,e){return this.http.patch(`${m.a.API_URL}/users/${t}`,e).pipe(Object(b.a)(this.handlerError))}delete(t){return this.http.delete(`${m.a.API_URL}/users/${t}`).pipe(Object(b.a)(this.handlerError))}handlerError(t){let e="Error unknown";return t&&(e="Error "+t.message),window.alert(e),Object(u.a)(e)}}return t.\u0275fac=function(e){return new(e||t)(l.Wb(h.b))},t.\u0275prov=l.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var p=o("3Pt+"),w=o("kmnG"),S=o("qFsG"),v=o("d3UM"),g=o("FKr1"),y=o("bTqV"),R=o("NFeN");function F(t,e){if(1&t&&(l.Sb(0,"mat-error"),l.zc(1),l.Rb()),2&t){const t=l.dc();l.Bb(1),l.Bc(" ",t.userForm.errorMessage," ")}}function O(t,e){if(1&t&&(l.Sb(0,"mat-error"),l.zc(1),l.Rb()),2&t){const t=l.dc(2);l.Bb(1),l.Bc(" ",t.userForm.errorMessage," ")}}function D(t,e){if(1&t){const t=l.Tb();l.Sb(0,"mat-form-field",3),l.Nb(1,"input",13),l.Sb(2,"button",14),l.Zb("click",(function(){l.qc(t);const e=l.dc();return e.hide=!e.hide})),l.Sb(3,"mat-icon"),l.zc(4),l.Rb(),l.Rb(),l.yc(5,O,2,1,"mat-error",5),l.Rb()}if(2&t){const t=l.dc();l.Bb(1),l.jc("type",t.hide?"password":"text"),l.Bb(3),l.Ac(t.hide?"visibility_off":"visibility"),l.Bb(1),l.jc("ngIf",t.checkField("password"))}}function C(t,e){if(1&t&&(l.Sb(0,"mat-error"),l.zc(1),l.Rb()),2&t){const t=l.dc();l.Bb(1),l.Bc(" ",t.userForm.errorMessage," ")}}var k=function(t){return t.EDIT="edit",t.NEW="new",t}({});let B=(()=>{class t{constructor(t,e,o){this.data=t,this.userForm=e,this.userSvc=o,this.actionTODO=k.NEW,this.showPasswordField=!0,this.hide=!0}ngOnInit(){var t;(null===(t=this.data)||void 0===t?void 0:t.user.hasOwnProperty("id"))&&(this.actionTODO=k.EDIT,this.showPasswordField=!1,this.userForm.baseForm.get("password").setValidators(null),this.userForm.baseForm.updateValueAndValidity(),this.data.title="Edit user",this.pathFormData())}onSave(){var t,e;const o=this.userForm.baseForm.value;if(this.actionTODO===k.NEW)this.userSvc.new(o).subscribe(t=>{console.log("New ",t)});else{const r=null===(e=null===(t=this.data)||void 0===t?void 0:t.user)||void 0===e?void 0:e.id;this.userSvc.update(r,o).subscribe(t=>{console.log("Update",t)})}}checkField(t){return this.userForm.isValidField(t)}pathFormData(){var t,e,o,r;this.userForm.baseForm.patchValue({email:null===(e=null===(t=this.data)||void 0===t?void 0:t.user)||void 0===e?void 0:e.email,role:null===(r=null===(o=this.data)||void 0===o?void 0:o.user)||void 0===r?void 0:r.role})}}return t.\u0275fac=function(e){return new(e||t)(l.Mb(s.a),l.Mb(d.a),l.Mb(f))},t.\u0275cmp=l.Gb({type:t,selectors:[["app-modal"]],decls:23,vars:7,consts:[["mat-dialog-title",""],[1,"modal-form"],[3,"formGroup"],[1,"full-width-input"],["formControlName","email","matInput","","placeholder","Email","required",""],[4,"ngIf"],["class","full-width-input",4,"ngIf"],["formControlName","role"],["value","suscriptor"],["value","admin"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-raised-button","","color","primary","ckdFocusInitial","",3,"mat-dialog-close","disabled","click"],["formControlName","password","matInput","","placeholder","Password","required","",3,"type"],["mat-icon-button","","matSuffix","",3,"click"]],template:function(t,e){1&t&&(l.Sb(0,"h2",0),l.zc(1),l.Rb(),l.Sb(2,"mat-dialog-content"),l.Sb(3,"div",1),l.Sb(4,"form",2),l.Sb(5,"mat-form-field",3),l.Nb(6,"input",4),l.yc(7,F,2,1,"mat-error",5),l.Rb(),l.yc(8,D,6,3,"mat-form-field",6),l.Sb(9,"mat-form-field",3),l.Sb(10,"mat-label"),l.zc(11,"Select "),l.Rb(),l.Sb(12,"mat-select",7),l.Sb(13,"mat-option",8),l.zc(14,"Suscriptor"),l.Rb(),l.Sb(15,"mat-option",9),l.zc(16,"Admin"),l.Rb(),l.Rb(),l.yc(17,C,2,1,"mat-error",5),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Sb(18,"mat-dialog-actions",10),l.Sb(19,"button",11),l.zc(20,"Cancel"),l.Rb(),l.Sb(21,"button",12),l.Zb("click",(function(){return e.onSave()})),l.zc(22," Save "),l.Rb(),l.Rb()),2&t&&(l.Bb(1),l.Ac(null==e.data?null:e.data.title),l.Bb(3),l.jc("formGroup",e.userForm.baseForm),l.Bb(3),l.jc("ngIf",e.checkField("email")),l.Bb(1),l.jc("ngIf",e.showPasswordField),l.Bb(9),l.jc("ngIf",e.checkField("role")),l.Bb(4),l.jc("mat-dialog-close",!0)("disabled",!e.userForm.baseForm.valid))},directives:[s.g,s.e,p.u,p.o,p.i,w.c,p.c,S.b,p.n,p.g,p.s,r.k,w.f,v.a,g.n,s.c,y.a,s.d,w.b,w.g,R.a],styles:[".modal-form[_ngcontent-%COMP%]{padding:1rem 0}.modal-form[_ngcontent-%COMP%]   .full-width-input[_ngcontent-%COMP%]{width:100%}"]}),t})();var I=o("XNiG");function P(t,e){1&t&&(l.Sb(0,"th",11),l.zc(1,"No."),l.Rb())}function z(t,e){if(1&t&&(l.Sb(0,"td",12),l.zc(1),l.Rb()),2&t){const t=e.$implicit;l.Bb(1),l.Ac(t.id)}}function M(t,e){1&t&&(l.Sb(0,"th",11),l.zc(1,"Role"),l.Rb())}function j(t,e){if(1&t&&(l.Sb(0,"td",12),l.zc(1),l.Rb()),2&t){const t=e.$implicit;l.Bb(1),l.Ac(t.role)}}function A(t,e){1&t&&(l.Sb(0,"th",11),l.zc(1,"Email"),l.Rb())}function E(t,e){if(1&t&&(l.Sb(0,"td",12),l.zc(1),l.Rb()),2&t){const t=e.$implicit;l.Bb(1),l.Ac(t.email)}}function N(t,e){1&t&&(l.Sb(0,"th",11),l.zc(1,"Actions"),l.Rb())}function $(t,e){if(1&t){const t=l.Tb();l.Sb(0,"td",12),l.Sb(1,"div",0),l.Sb(2,"button",13),l.Zb("click",(function(){l.qc(t);const o=e.$implicit;return l.dc().onOpenModal(o)})),l.zc(3," Edit "),l.Rb(),l.Sb(4,"button",14),l.Zb("click",(function(){l.qc(t);const o=e.$implicit;return l.dc().onDelete(o.id)})),l.zc(5," Delete "),l.Rb(),l.Rb(),l.Rb()}}function _(t,e){1&t&&l.Nb(0,"tr",15)}function G(t,e){1&t&&l.Nb(0,"tr",16)}const U=[{path:"",component:(()=>{class t{constructor(t,e){this.userSvc=t,this.dialog=e,this.displayedColumns=["id","role","email","actions"],this.dataSource=new n.l,this.destroy$=new I.a}ngOnInit(){this.userSvc.getAll().subscribe(t=>{this.dataSource.data=t})}ngAfterViewInit(){this.dataSource.sort=this.sort}onDelete(t){window.confirm("Do you really want remove this user")&&this.userSvc.delete(t).pipe(Object(i.a)(this.destroy$)).subscribe(t=>{window.alert(t),this.userSvc.getAll().subscribe(t=>{this.dataSource.data=t})})}onOpenModal(t={}){console.log("User->",t),this.dialog.open(B,{height:"400px",width:"600px",hasBackdrop:!1,data:{title:"New user",user:t}}).afterClosed().subscribe(t=>{console.log("Dialog result: "+t,typeof t),this.userSvc.getAll().subscribe(t=>{this.dataSource.data=t})})}ngOnDestroy(){this.destroy$.next({}),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(l.Mb(f),l.Mb(s.b))},t.\u0275cmp=l.Gb({type:t,selectors:[["app-users"]],viewQuery:function(t,e){var o;1&t&&l.Cc(c.a,!0),2&t&&l.nc(o=l.ac())&&(e.sort=o.first)},decls:18,vars:3,consts:[[1,"table-button-row"],["mat-flat-button","","color","primary",1,"btn-new",3,"click"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","role"],["matColumnDef","email"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-flat-button","","color","accent",3,"click"],["mat-flat-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(l.Sb(0,"div",0),l.Sb(1,"button",1),l.Zb("click",(function(){return e.onOpenModal()})),l.zc(2," Add new "),l.Rb(),l.Rb(),l.Sb(3,"table",2),l.Qb(4,3),l.yc(5,P,2,0,"th",4),l.yc(6,z,2,1,"td",5),l.Pb(),l.Qb(7,6),l.yc(8,M,2,0,"th",4),l.yc(9,j,2,1,"td",5),l.Pb(),l.Qb(10,7),l.yc(11,A,2,0,"th",4),l.yc(12,E,2,1,"td",5),l.Pb(),l.Qb(13,8),l.yc(14,N,2,0,"th",4),l.yc(15,$,6,0,"td",5),l.Pb(),l.yc(16,_,1,0,"tr",9),l.yc(17,G,1,0,"tr",10),l.Rb()),2&t&&(l.Bb(3),l.jc("dataSource",e.dataSource),l.Bb(13),l.jc("matHeaderRowDef",e.displayedColumns),l.Bb(1),l.jc("matRowDefColumns",e.displayedColumns))},directives:[y.a,n.k,c.a,n.c,n.e,n.b,n.g,n.j,n.d,c.b,n.a,n.f,n.i],styles:["table[_ngcontent-%COMP%]{width:98%;margin:1rem auto 0}th.mat-sort-header-sorted[_ngcontent-%COMP%]{color:#000}.table-button-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:12px}.btn-new[_ngcontent-%COMP%]{width:20%}"]}),t})()}];let T=(()=>{class t{}return t.\u0275mod=l.Kb({type:t}),t.\u0275inj=l.Jb({factory:function(e){return new(e||t)},imports:[[a.e.forChild(U)],a.e]}),t})();var q=o("vvyD");let x=(()=>{class t{}return t.\u0275mod=l.Kb({type:t}),t.\u0275inj=l.Jb({factory:function(e){return new(e||t)},imports:[[r.c,T,q.a]]}),t})()}}]);